SHOW DATABASES;
create database insurance_;
show databases;
use insurance;
create table person(driver_id varchar(10),name varchar(20),address varchar(30),primary key(driver_id));
desc person;
create table car(reg_num varchar(10),model varchar(10),year int,primary key(reg_num));
desc car;
create table accident(report_num int,accident_date date,location varchar(30),primary key(report_num));
desc accident;
insert into person(driver_id,name,address) values ("A1","AYUSH SAHU","KORBA");
insert into person(driver_id,name,address) values ("A2","MOHALAL","BILASPUR");
insert into person(driver_id,name,address) values ("A3","AVI MISHRA","RAJAJINAGAR");
insert into person(driver_id,name,address) values ("A4","MAYANK RATHORE","BALAJINAGAR");
insert into person(driver_id,name,address) values ("A5","SAYANSH SINGH","GANDHINAGAR");

SELECT*FROM PERSON;
create table owns(driver_id varchar(10),reg_num varchar(10),primary key(driver_id,reg_num),foreign key(driver_id) references person(driver_id),foreign key(reg_num) references car(reg_num));
desc owns;
create table participated(driver_id varchar(10), reg_num varchar(10),report_num int, damage_amount int, primary key(driver_id, reg_num, report_num), foreign key(driver_id) references person(driver_id),
foreign key(reg_num) references car(reg_num),foreign key(report_num) references accident(report_num));
insert into car(reg_num,model,year) values ("KA052250","INDICA","1990");
insert into car(reg_num,model,year) values ("KA052567","HONDA","1995");
insert into car(reg_num,model,year) values ("KA052678","AUDI","2014");
insert into car(reg_num,model,year) values ("KA056667","TOYOTA","1998");
insert into car(reg_num,model,year) values ("KA056697","LANCA","1957");
insert into accident values(111,'2005-01-03','Mysore Road');
insert into accident values(112,'2014-12-03','Gundappa Road');
insert into accident values(113,'2004-09-05','Hazaribagh Road');
insert into accident values(114,'2005-10-06','SouthernCircle');
insert into accident values(115,'2001-05-02','GANDHI bazar');
insert into owns values("A1","KA052250");
insert into owns values("A2","KA052567");
insert into owns values("A3","KA052678");
insert into owns values("A4","KA056667");
insert into owns values("A5","KA056697");
insert into PARTICIPATED values("A1","KA052250",111,10000);
insert into PARTICIPATED values("A2","KA052567",112,50000);
insert into PARTICIPATED values("A3","KA052678",113,25000);
insert into PARTICIPATED values("A4","KA056667",114,3000);
insert into PARTICIPATED values("A5","KA056697",115,5000);
update participated set damage_amount = 25000 where reg_num="KA052250" and report_num=111;
select * from participated;
insert into accident values(116,'2002-03-15','Domlur');
Select accident_date,location from accident;
Select driver_id from participated where damage_amount>=25000;
Select * from car order by year asc;
select count(report_num)from car c,participated p where c.reg_num=p.reg_num and c.model="LANCA";
select count(distinct driver_id) from participated p,accident a where p.report_num=a.report_num and a.accident_date like '2001%';
select * from participated order by damage_amount desc;
select avg(damage_amount)from participated;
select max(damage_amount) from participated;

DELETE FROM participated WHERE damage_amount < (SELECT avg_val FROM (SELECT AVG(damage_amount) AS avg_val FROM participated) AS temp);
select distinct pe.name,pa.damage_amount  from participated pa,person pe where pa.driver_id=pe.driver_id and pa.damage_amount>(select avg(damage_amount)from participated);
